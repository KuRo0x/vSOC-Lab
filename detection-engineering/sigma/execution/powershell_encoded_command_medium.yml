title: PowerShell Execution With Encoded Command
id: 6c3c0e16-9f5a-4b1a-8a9a-1a2b3c4d5e70
status: experimental
description: Detects PowerShell launched with an encoded command flag, commonly used to obfuscate commands.
author: KuRo
date: 2026-02-04
tags:
  - attack.execution
  - attack.t1059.001

logsource:
  product: windows
  category: process_creation

detection:
  selection_powershell:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'

  selection_encoded:
    CommandLine|re: '(?i)\s(-encodedcommand|-enc|/encodedcommand|/enc)\s+[A-Za-z0-9+/=]{20,}'

  filter_management_tools:
    ParentImage|endswith:
      - '\ccmexec.exe'
      - '\sccmexec.exe'

  condition: selection_powershell and selection_encoded and not filter_management_tools

falsepositives:
  - Legitimate administrative automation and management tools that use encoded PowerShell
level: medium
