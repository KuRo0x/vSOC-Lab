title: Suspicious Service Creation via sc.exe
id: 1c2d3e4f-5a6b-4c7d-8e9f-0a1b2c3d4e5f
status: experimental
description: Detects sc.exe service creation with suspicious characteristics (remote creation, unusual binPath locations, or stealthy start types).
author: KuRo
date: 2026-02-04
tags:
  - attack.persistence
  - attack.t1543.003
  - attack.lateral_movement

logsource:
  product: windows
  category: process_creation

detection:
  selection_sc_create:
    Image|endswith: '\sc.exe'
    CommandLine|re: '(?i)\bcreate\b'

  selection_remote:
    CommandLine|re: '(?i)\s+\\\\[^\\]+'

  selection_suspicious_paths:
    CommandLine|contains:
      - '\Users\Public\'
      - '\AppData\Local\Temp\'
      - '\Windows\Temp\'
      - '\ProgramData\'
      - ':\Temp\'

  selection_suspicious_start:
    CommandLine|contains:
      - ' start= auto'
      - ' start= demand'
      - ' start= disabled'

  condition: selection_sc_create and (selection_remote or selection_suspicious_paths or selection_suspicious_start)

falsepositives:
  - Remote administration tools legitimately creating services
  - Some enterprise deployment tools creating services from ProgramData or Temp during staging
level: high
